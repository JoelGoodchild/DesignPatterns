#include "Loading.h"
#include "Texture.h"
#include "Input.h"
#include "StateMachine.h"
#include <assert.h>
//---------------------------------------------------------------------------------------
Loading::Loading()
{
	//---------------------------------------------------------------------------------------
	//Creates all sprites for the loading state 
	//And asserts to ensure they are created successfully
	//---------------------------------------------------------------------------------------
	loading = new Texture("./textures/loading.png");
	assert(loading);
	questionMark = new Texture("./textures/questionMark.png");
	assert(questionMark);

	//---------------------------------------------------------------------------------------
	//Sets the variable for the rotation of the question mark
	//---------------------------------------------------------------------------------------
	rot = 0;

	//---------------------------------------------------------------------------------------
	//Variable to set the opacity of the sprites
	//---------------------------------------------------------------------------------------
	x = 0;

	//---------------------------------------------------------------------------------------
	//Times how long you are in the state for
	//---------------------------------------------------------------------------------------
	time = 0;
}
//---------------------------------------------------------------------------------------
Loading::~Loading()
{
	delete questionMark;
	delete loading;
}
//---------------------------------------------------------------------------------------
void Loading::OnEnter(){} //LEFT BLANK
//---------------------------------------------------------------------------------------
void Loading::OnUpdate(float DeltaTime, StateMachine * state)
{
	Input* input = Input::getInstance();

	//---------------------------------------------------------------------------------------
	//Changes the angle of rotation
	//---------------------------------------------------------------------------------------
	rot += 4 * DeltaTime;

	//---------------------------------------------------------------------------------------
	//Changes the opacity of the sprites
	//---------------------------------------------------------------------------------------
	x += DeltaTime;

	//---------------------------------------------------------------------------------------
	//Changes to the game state after 5 seconds
	//---------------------------------------------------------------------------------------
	time += DeltaTime;
	if (time >= 5)
		state->PushState(3);
}
//---------------------------------------------------------------------------------------
void Loading::OnDraw(Renderer2D* m_2dRenderer)
{
	//---------------------------------------------------------------------------------------
	//Sets the opacity of the sprites to be drawn, and then draws them
	//---------------------------------------------------------------------------------------
	m_2dRenderer->setRenderColour(1, 1, 1, x);
	m_2dRenderer->drawSprite(loading, 170, 40);
	m_2dRenderer->drawSprite(questionMark, 700, 360, 0, 0, -rot);
}
//---------------------------------------------------------------------------------------
void Loading::OnExit(){} //LEFT BLANK